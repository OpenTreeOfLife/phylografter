State of Tree Grafting : 2013/01/29

Currently, to create a grafted tree using phylografter, one must be looking at a study ( /study/view/{$studyId} ) and select a link titled, 'Use as grafted tree backbone'.  The user must be logged in to see the link.  Clicking on it will take you to /gtree/backbone/{$sourceTreeId}.  To edit the tree, right click on a node of interest.  You can prune a node off of the tree, or replace a node in the tree with a node ( source or grafted ) saved to the clipboard, or add a child clade to the right-clicked node from the clipboard.  I was successful in each of these actions.  Sometimes, there is a minor UI issue where the modal dialogue that displays the clipboard clades that can be used to replace clade or graft onto the tree has its background color cut off at the bottom.  I believe this is because another modal dialouge UI sets the height of the modal box to a specific value that is never reset.

When a grafted tree is created, only the creator can make edits to it ( add child, prune, replace ).  Also, the creator of a tree is able to give edit privileges on the tree to other users of phylografter.  In order to do this, the creator can hover the mouse over the control panel, then hover the 'graft options' menu item, and select 'Let Colleagues Edit Tree' option.  It will bring up a UI with two lists, a 'Can Edit' list and an 'Unable to Edit' list.  The user can give edit privileges to users by selecting them in a list and clicking an arrow to move them between lists.  There is also a search text box that can be used to filter the lists based on a user's name.  

One thing to note regarding the user lists : A user is determined by email address, so some people's names will be in the list twice.  It may be a good idea to show the email address along with the user names in this interface, so that you know to what email address you are giving privileges to.

I was just able to create a grafted tree, and give edit permissions to myself ( on a different email address ).  I then logged in with this non-creator email address and was able to prune, graft, and replace a clade.  Previous to the edit privileges being given, I logged in with the non-creator email address and was unable to edit the tree.

Also, functionality for reverting edits made to a grafted tree have been added to phylografter.  Someone with edit privileges is able to revert any edit to the tree except the first ( reverting the first edit would make it exactly the same as the original source backbone tree ).  Over the past couple of days, I have been testing this.  I have reverted trees in many situations, and am confident that this functionality is stable, however, I wouldn't be surprised if there's a hidden use case I could not think of that somehow breaks this functionality for an obscure instance.

To revert a tree or simply view the edits made to a particular grafted tree, a user can find it in the control panel under graft options.  The option is called 'View Tree Edits'.  Clicking it brings up a list of the edits made to a tree.  If the user has edit privileges, on the right side of each list item is a link that says 'Revert Edit'.  Clicking this will display the tree in the state it was before the specified edit.  Editing this tree is disabled, and there is a dialogue at the top of the tree viewer panel asking the user if they would like to revert the tree permanently.  Clicking cancel brings back the latest version of the grafted tree, while clicking 'Yes' will revert the tree back to the specified state.  There is no way to revert the revert.  This workflow could probably use better visual indicators of what is going on.  Perhaps highlighting clades would be a start.

